
#################################################
# This implementation takes 7.8 seconds per run #
############################################### #

__concat(a, b) -> if(!a, b,
	__concat(\a, 'a : b)
),

_concat(a, b) -> __concat(reverse(a), b),

concat(x.) -> reducel(_concat, x),

# sort(x) -> if(!x, ., 
# 	concat(
# 		sort(filter((i) -> i < 'x, x)),
# 		filter((i) -> i == 'x, x),
# 		sort(filter((i) -> i > 'x, x))
# 	)
# ),

#################################################
# This implementation takes 6.4 seconds per run #
############################################### #

_sort(x, h) -> if (!x, h:.,
	concat(
		sort(filter((i) -> i < h, x)),
		filter((i) -> i == h, x),
		sort(filter((i) -> i > h, x))
	)
),

sort(x) -> if(x, _sort(\x, 'x), .),

#################
# Testing stuff #
#################

is_sorted(l) -> reduce(and, map((x) -> 'x < '\x, zip(l, \l))),

_LIST_ = list(5172, 7702, 6509, 3575, 4687, 389, 5230, 6848, 1837, 9020, 2479, 4624, 3747, 123, 2509, 1017, 3352, 6647, 5152, 5656, 4594, 9056, 6403, 8894, 6827, 470, 2541, 2488, 1825, 9978, 926, 5721, 6736, 9075, 225, 9899, 3153, 6343, 5614, 1905, 5978, 3131, 3719, 1419, 1784, 1650, 3686, 2222, 762, 6376, 6084, 658, 9878, 5637, 469, 2230, 4818, 7107, 9098, 9312, 9182, 779, 6279, 9693, 146, 40, 4829, 6238, 2995, 6904, 2465, 8898, 3005, 1211, 4309, 9483, 8291, 6032, 369, 9380, 5101, 331, 9125, 5532, 899, 5001, 416, 1794, 427, 5693, 3644, 8036, 8404, 1051, 802, 2244, 3054, 807, 3154, 4407, 1322, 6266, 4271, 7717, 6385, 2478, 9999, 6106, 9919, 7790, 3400, 6394, 3533, 2311, 2534, 6579, 4824, 3870, 9692, 9995, 4890, 2945, 8175, 7673, 4633, 3044, 5804, 6916, 2264, 6432, 4602, 8183, 4881, 3452, 7477, 3652, 3440, 320, 3741, 8232, 9564, 5465, 4611, 6173, 7639, 1135, 5522, 697, 8909, 8641, 3130, 4524, 2184, 5782, 5569, 8523, 306, 4516, 2903, 9548, 5068, 288, 6718, 355, 7502, 5735, 6227, 5594, 7674, 5383, 4563, 8555, 783, 1422, 4266, 254, 1038, 3124, 9488, 4572, 1472, 4436, 7628, 1358, 5353, 8835, 747, 9864, 6020, 4043, 3151, 7551, 8068, 2535, 1921, 7755, 9468, 3699, 576, 7235, 5507, 1953, 3571, 9614, 3654, 6013, 6372, 8513, 9540, 7035, 3906, 3846, 3499, 8792, 2755, 3811, 290, 9284, 350, 3016, 5318, 6957, 3274, 2396, 6608, 7309, 3936, 4499, 8278, 4191, 990, 7366, 5962, 7963, 422, 5765, 5200, 6675, 1309, 2312, 3010, 4681, 1978, 2338, 1486, 848, 9374, 5239, 2801, 4660, 4933, 4148, 712, 918, 6476, 2619, 1700, 5924, 1370, 4346, 9617, 1067, 4759, 2517, 7672, 7492, 1033, 7683, 6317, 1060, 3893, 8767, 9696, 6693, 9977, 1604, 3971, 1793, 8505, 2354, 7630, 6224, 2539, 278, 3712, 6980, 3783, 5028, 1515, 7197, 5268, 4388, 6425, 7609, 1499, 503, 9826, 3645, 1577, 3142, 7099, 7428, 1161, 8807, 5069, 597, 36, 6284, 8504, 6707, 1107, 6640, 1317, 8318, 6270, 8115, 983, 5860, 2549, 1137, 4282, 7469, 883, 2997, 9901, 9196, 4504, 3228, 657, 7291, 7943, 3978, 4262, 2978, 8007, 1568, 6215, 9795, 5598, 8432, 375, 1719, 8272, 4326, 2820, 3633, 3048, 9331, 8623, 3429, 8495, 7754, 7215, 7329, 7516, 3279, 4041, 5647, 4855, 5491, 8185, 8985, 8990, 1258, 3092, 8256, 5302, 6967, 9802, 4727, 625, 2483, 7411, 4696, 1138, 2990, 993, 5658, 5514, 4125, 3798, 6920, 8967, 937, 6010, 3683, 1685, 8324, 1344, 932, 372, 6847, 8563, 6365, 1621, 2467, 7819, 6614, 909, 7100, 6888, 7219, 621, 5206, 9033, 500), 

is_sorted(sort(_LIST_)),

sort(_LIST_)

# is_sorted(list(1, 2, 3, 4))